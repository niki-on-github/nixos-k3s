apiVersion: volsync.backube/v1alpha1
kind: ReplicationSource
metadata:
  name: "${APP_NAME}-backup"
  namespace: "${APP_NAMESPACE}"
spec:
  sourcePVC: "${APP_NAME}-pvc"
  trigger:
    schedule: "0 3 * * *"
    # change/inc below to perform a manual backup schedule once
    # TODO enable manual sync diable scheduling!?
    # see https://github.com/backube/volsync/discussions/576
    # bad sw design?
    # manual: "manual-backup-0003"
  restic:
    # NOTE: when your repository has a stale lock that prevents backups increment the number in string below to perform an unlock before the next backup
    unlock: "unlock-00001"
    repository: "${APP_NAME}-restic-dest-credentials"
    copyMethod: Direct
    cacheStorageClassName: local-temp
    pruneIntervalDays: 14
    retain:
      hourly: 6
      daily: 5
      weekly: 4
      monthly: 2
      yearly: 1
